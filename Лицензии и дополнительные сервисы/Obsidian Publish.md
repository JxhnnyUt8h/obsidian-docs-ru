Obsidian Publish™ — это платный хостинг сервис для ваших заметок.

Инструкции по публикации Ваших заметок из приложения Obsidian смотрите в разделе [[Публикация]].

### Конфиденциальность

У вас есть полный контроль над тем, что публиковать с помощью плагина [[Публикация]] — это либо всё ваше хранилище, либо только выбранные заметки в вашем хранилище. Что касается любых заметок, которые вы выбрали **не** для публикации, вы можете быть уверены, что эти заметки остаются полностью конфиденциальными и Obsidian Publish не имеет никакого представления о них.

### Резервное копирование

Пожалуйста, обратите внимание, что Obsidian Publish не должен использоваться в качестве резервной копии ваших данных. Убедитесь в том, что у вас всегда есть своя резервная копия вашего сайта, используя выбранный вами метод резервного копирования. Наши усилия по поддержке Obsidian Publish будут в основном сосредоточены на функциональности, простоте использования и доступности сайта.

### Демонстрационная версия

Есть большая вероятность, что вы уже просматриваете эту статью на нашем официальном сайте созданном с помощью Obsidian Publish.

Если нет, то вы можете ознакомиться с демонстрационной версией тут: https://publish.obsidian.md/help.

### Что включено в сервис?

Сервис Obsidian Publish позволяет вам создать свой сайт непосредственно из приложения Obsidian, выбрав заметки, которые вы хотите опубликовать.

Вы можете настроить свой сайт, выбрать светлый или темный режим оформления, а также изменить длину строки и другие параметры.

Существует несколько компонентов, которые могут быть включены или выключены в плагине [[Публикация]]. Изменения этих параметров будут отражены на вашем опубликованном сайте после очистки кэша, как правило, в течение 5 минут.

##### Отображение навигации

Включение этого параметра добавляет боковую панель навигации, где отображаются все опубликованные страницы и папки, в которых они находятся. Пользователи увидят, что текущая открытая заметка подсвечена, и смогут нажать на любую другую заметку для перехода к ней.

##### Панель поиска

Добавляет панель поиска на страницу. Эта панель может быть использована для поиска страниц, псевдонимов и заголовков внутри страниц. В настоящее время она не осуществляет полнотекстовый поиск по содержанию сайта.

##### Отображение графа

Отображает локальный граф страницы открытой а данный момент. При этом используется тот же самый движок рендеринга, что и для плагина [[Граф]] в Obsidian.

##### Отображение оглавления

Отображает оглавление страницы открытой в данный момент. Список формируется из заголовков внутри страницы, подобно работе плагина [[Структура]]. Пользователи, перемещающиеся по заметке, увидят соответствующий заголовок, подсвеченный при прокрутке, и могут нажать на другой заголовок для немедленного перемещения к нему.

##### Отображение обратных ссылок

Отображает раздел в конце каждой страницы под названием «Ссылки на эту страницу», содержащий обратные ссылки с других страниц. Если обратных ссылок нет, раздел отображаться не будет.

##### Теги

Когда читатель нажмет на тег, он может увидеть список других страниц, которые включают в себя этот тег.

##### Отображение предварительного просмотра

При наведении указателя мыши на ссылки их содержимое отображается во всплывающем окне. Это работает аналогично плагину [[Предпросмотр страницы]] в Obsidian.

##### Пользовательский CSS

Для настройки стиля вашего сайта, вы можете загрузить `publish.css`. Этот файл должен быть сохранен в корневой папке вашего сайта. Вы можете использовать существующую тему и добавить некоторые дополнительные настройки публикации в `publish.css`.

##### Favicon

Чтобы изменить favicon вашего сайта, вы можете загрузить `png` иконки любого размера в формате `favicon-32.png` или `favicon-32x32.png`. Вы также можете загрузить файл `favicon.ico`. Эти файлы могут быть сохранены в любой папке. В настоящее время (по состоянию на 2020 год) рекомендуется создавать иконки с размерами `32×32`, `128x128`, `152×152`, `167x167`, `180x180`, `192x192` и `196x196`.

##### Пользовательский JS

Если вы хотите использовать свой собственный JavaScript код, или интегрировать Discus!, Discourse и т.д., вы можете сделать это, загрузив `publish.js` в корневой каталог вашего хранилища. Обратите внимание, что эти скрипты будут выполняться только для посетителей вашего личного домена.

##### Запрет индексирования в поисковых системах

Этот параметр добавляет мета-тег "noindex" на все ваши страницы, чтобы поисковые системы, такие как Google, не индексировали ваш сайт. Обратите внимание, что поисковые системы в любом случае не смогут индексировать ваш сайт, если он защищен паролем.

##### Google Analytics

Если вы хотите установить Google Analytics для вашего сайта, сначала убедитесь, что ваши местные законы и правила позволяют делать это. Затем, вам просто нужно поместить код отслеживания в виде `UA-XXXXX-Y` в текстовое поле, и ваш сайт будет автоматически отслеживать просмотры страниц. Обратите внимание, что Google Analytics доступен только для посетителей с вашего личного домена.

При тестировании Google Analytics, пожалуйста, убедитесь, что вы отключили любые блокирующие рекламу расширения для браузера, такие как uBlock Origin, который, в том числе блокирует работу скриптов Google Analytics.

Кроме того, Obsidian Publish на данный момент не совместим с Google Tag Manager напрямую — вы можете настроить его с помощью пользовательского JavaScript, если вы хотите использовать Google Tag Manager вместо Google Analytics.

### Личный домен

Вы можете настроить собственный домен или поддомен для вашего сайта в Obsidian Publish. В настоящее время у нас ещё нет возможности предоставить SSL-сертификат от вашего имени, поэтому вам необходимо прибегнуть либо к собственному серверу с поддержкой SSL, либо настроить ваш сайт в сервисе CloudFlare, который предоставляет SSL-сертификат бесплатно.

Вы также можете настроить Obsidian Publish как sub-URL сайта, которым вы владеете. Например, `https://mysite.com/my-notes/`. Для этого вы должны разместить свой собственный сервер и проксировать все запросы к нашему серверу по адресу `https://publish.obsidian.md/`.

Продолжайте чтение для получения подробной информации по настройкам.

#### Настройка CloudFlare

Самый простой способ настроить собственный домен или поддомен — это создать учетную запись в [CloudFlare](https://cloudflare.com) и позволить CloudFlare управлять вашим доменом. Это позволит вам добавить SSL на ваш сайт бесплатно, а также обеспечить быструю работу вашего сайта в любой точке мира, откуда он может быть доступен. Обычно пользователи размещают содержимое своего сайта в Obsidian Publish на корневом домене (например, `mysite.com`) или на поддомене (например, `notes.mysite.com`). Эти инструкции работают в обоих случаях.

1. Откройте CloudFlare для домена, который вы хотите добавить в Publish (например, `mysite.com`, даже если вы хотите поддомен, например, `notes.mysite.com`).
2. Перейдите в DNS и нажмите кнопку «Добавить запись» (Add Record). Выберите CNAME и в поле «Имя» (name) введите желаемый домен или поддомен (например, `notes.mysite.com`). В поле «Цель» (target) введите значение `publish-main.obsidian.md`. Не включайте в это значение ваш sub-URL, так как Obsidian Publish обрабатывает это с помощью вашей конфигурации.
3. Перейдите в раздел SSL/TLS и установите режим шифрования SSL/TLS на `Полное` (Full). Это автоматически настроит сертификат SSL/TLS.

После того как вы закончите настройку в CloudFlare, вы можете перейти к настройкам вашего сайта в Obsidian, и установить URL для вашего домена или поддомена. Это позволит нашему серверу связать домен с вашим сайтом.

Устранение неполадок: если ваша настройка личного домена заканчивается циклическим перенаправлением, скорее всего в настройках CloudFlare выбран режим шифрования `Гибкое` (Flexible), вместо `Полное` (Full).

Если вы хотите настроить `mysite.com` и `www.mysite.com` на `Obsidian Publish`, вам нужно будет создать т.н. [Page Rules](https://support.cloudflare.com/hc/en-us/articles/200172336-Creating-Page-Rules) следующим образом:
- URL match: `www.mysite.com/*
- Forward URL - 301 Permanent redirect
- Redirect URL: `https://mysite.com/$1`

Как только вы создадите правило страницы, вы также должны создать запись CNAME для `www.mysite.com` так же, как вы создали ее для `mysite.com`.

#### Настройка прокси/переадресации

Если вы хотите разместить свой собственный веб-сервер и настроить собственное SSL-шифрование, вы можете выбрать этот параметр. Если вы уже размещаете сайт под вашим доменом или поддоменом, вы также можете использовать этот параметр и настроить ваш сайт для загрузки вашего Obsidian Publish сайта по определенному URL-адресу, вместо размещения полного сайта.

Просто проксируйте все запросы по этому URL-пути к `https://publish.obsidian.md/serve?url=mysite.com/my-notes/...` и **настройте параметры сайта в Obsidian на тот же путь**, указав `mysite.com/my-notes` для параметра **Custom URL**.

##### NGINX

```nginx
location /my-notes {
  proxy_pass https://publish.obsidian.md/serve?url=mysite.com/my-notes/;
  proxy_ssl_server_name on;
}
```

##### Apache

Добавьте следующие строки в `.htaccess`:

```htaccess
RewriteEngine  on
RewriteRule    "^my-notes/(.*)$"  "https://publish.obsidian.md/serve?url=mysite.com/my-notes/$1"  [L,P]
```

Примечание: mod_rewrite должен быть включен и возможно вам потребуется настроить [SSLProxyEngine](https://stackoverflow.com/questions/40938148/reverse-proxy-for-external-url-apache).

##### Netlify

```
[[redirects]]
  from = "https://mysite.com/my-notes/*"
  to = "https://publish.obsidian.md/serve?url=mysite.com/my-notes/:splat"
  status = 200
  force = true
```

##### Vercel

Настройте [rewrites](https://vercel.com/docs/configuration#project/rewrites) в `vercel.json`:

```json
{
  ...

  "rewrites": [
    {
      "source": "/my-notes/",
      "destination": "https://publish.obsidian.md/serve?url=mysite.com/my-notes"
    },
    {
      "source": "/my-notes/:path*",
      "destination": "https://publish.obsidian.md/serve?url=mysite.com/my-notes/:path*"
    }
  ]
}
```

##### Поддержка нестандартных HTTP-заголовков

В качестве альтернативы, если ваша прокси-сервис не поддерживает запросы путей, вы можете использовать `https://publish.obsidian.md/` со специальным заголовком `x-obsidian-custom-domain`, настроенным на адрес вашего сайта `mysite.com/my-subpath`.

#### Проблемы после настройки личного домена

После настройки личного домена, если вы заходили на сайт по предыдущей ссылке `https://publish.obsidian.md/slug`, вам, возможно, придется очистить кэш браузера, чтобы определенные вещи (например, шрифты, графики или доступ по паролю) работали правильно. Это связано с ограничениями междоменной безопасности, которые накладываются современными браузерами. Хорошая новость заключается в том, что посетители вашего сайта никогда не должны сталкиваться с подобной проблемой, если вы разрешаете использовать им только свой личный домен.

#### Перенаправление старого сайта на личный домен

Если вы хотите перенаправить пользователей со старого `publish.obsidian.md` сайта на ваш новый личный домен, есть возможность включить в настройках личного домена страницу, которая сделает именно это.

### Скоро будет

Obsidian Publish всё ещё находится в начале пути своего развития. Вот некоторые функции, которые мы планируем добавить:

- Полная поддержка пользовательских доменов (с предоставлением SSL-сертификатов).
- Полнотекстовый поиск.
- Больше встроенных тем.

Пожалуйста, сообщите нам, если у вас есть какие-то предложения по расширению функциональности Obsidian Publish, отправив [запрос на форум](https://forum.obsidian.md/).

### Цены

Цены на Obsidian Publish можно узнать на странице [расценок](https://obsidian.md/pricing).

### Технические подробности

Obsidian Publish использует Cloudflare в качестве CDN (сеть доставки контента) для предоставления быстрого доступа к вашему сайту по всему миру. Это включает в себя кэширование копий файлов вашего сайта в более чем 200 центрах обработки данных, чтобы обеспечить минимальное время задержки для ваших посетителей. При этом быстро работает и загружается, даже если ваш посетитель живет далеко от наших основных серверов.

Однако это означает, если вы меняете настройки сайта, публикуете новый контент или убираете его из общего доступа, посетители могут не видеть последнюю версию сайте в течение некоторого времени. В настоящее время наш кэш настроен на хранение данных в течение часа, прежде чем они будут «перепроверены», чтобы убедиться, что содержимое не изменилось.

Если вы только что опубликовали что-то, но всё ещё видите более старую версию, вы можете выполнить «жесткое обновление» страницы, удерживая кнопку перезагрузки и выбрав «Жесткое обновление» в выпадающем меню. В противном случае вы можете попробовать очистить кэш браузера или отключить кэш с помощью инструментов разработчика на вкладке «Сеть». ==Данные способы работают в браузере Chrome после включения инструментов разработчика по `F12`.==

#### Хостинг медиафайлов

Несмотря на то, что Obsidian Publish позволяет загружать видеоклипы, он не оптимизирован для видео. Таким образом, ваши посетители могут обнаружить, что просмотр видео на вашем сайте может не доставлять большого удовольствия.

Мы рекомендуем использовать подходящие сервисы видеохостинга, такие, как YouTube или Vimeo, для размещения ваших видео для Obsidian Publish. Преимущества использования правильного видео хостинга включают в себя следующее:

- Автоматическая перекодировка гарантирует, что ваше видео может быть воспроизведено на всех мобильных устройствах независимо от того, какой формат кодирования вы использовали в исходном файле.
- Динамическая настройка качества в зависимости от доступности полосы пропускания и обеспечивает плавное воспроизведение видео без постоянных пауз для «буферизации».
- Высокоэффективное сжатие видео, гарантирующее, что посетители не превысят свои лимиты передачи данных при просмотре вашего сайта.
- Глобальная CDN позволяет быстро загружать видео независимо от того, где находится ваш посетитель.

---

### Связанные темы

Для получения более подробной информации о публикации заметок ознакомьтесь с плагином [[Публикация]].
